<script src="https://cdn.bootcdn.net/ajax/libs/jquery/3.6.0/jquery.min.js"></script>

<%- js('bootstrap/js/bootstrap.min.js') %>
<%# bootstrap.bundle.min.js replace popper.js cdn %>
<%- js('bootstrap/js/bootstrap.bundle.min.js') %>

<%- js('js/to_top.js') %>

<%# 图标 %>
<script src="//at.alicdn.com/t/font_2918710_naseliyedfg.js"></script>

<% if(theme.canvas.enable){ %>
    <%
        var a = theme.background.canvas.color,
        b = theme.background.canvas.zIndex,
        c = theme.background.canvas.opacity,
        d = theme.background.canvas.count;
    %>
    <%- js({ src: 'js/canvas.js', color: a ,zIndex: b,opacity: c,count: d}) %>
<% } %>

<%# fancybox%>
<% if(theme.fancybox.enable){ %>
        <script src="https://cdn.bootcdn.net/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js"></script>
<script>
// fancybox
/*
* 最笨的方法：用js给img套上a标签，得以使用fancybox。
*/
var imgs = document.querySelectorAll('.blog-post img');
imgs.forEach(function (img){
    var el = document.createElement('a');
    el.className = 'fancybox-group';
    el.setAttribute('data-fancybox','gallery');
    el.href = img.getAttribute('src');
    img.parentNode.replaceChild(el,img);
    el.appendChild(img);
})

$(document).ready(function() {
	/* This is basic - uses default settings */
	$("a.fancybox-group").fancybox();
});
</script>
<% } %>

<%- js('js/archives.js') %>
<%- js('js/index.js') %>
<script>
    calculateTime("<%= theme.startTime %>");
</script>

<%# 添加鼠标点击 效果%>
<% if(theme.mouseClick.showText.enable){ %>
    <%
        var txt = theme.mouseClick.showText.text,
        ShowColor = theme.mouseClick.showText.color;
    %>
    <%- js({ src: 'js/show_text.js', text: txt, id: 'showText', color:ShowColor}) %>
<% } else if(theme.mouseClick.showHeart){ %>
    <%- js({ src: 'js/show_heart.js'}) %>
<% } else if(theme.mouseClick.firework){ %>
    <script type="text/javascript" src="//cdn.bootcss.com/animejs/2.2.0/anime.min.js"></script>
    <%- js('js/firework.js') %>
<% } %>


<%# 添加 雪花飘落效果 %>
<% if(theme.snowFlake.enable){ %>
    <%- js({src: 'js/snowflake.js'}) %>
<% } %>

<%# 添加 mermaid %>
<% if(theme.mermaid.enable){ %>
<script src='https://unpkg.com/mermaid@<%- theme.mermaid.version %>/dist/mermaid.min.js'></script>
<script>
    mermaid.initialize({startOnLoad:true});
</script>
<% } %>

<%# 添加 MathJax %>
<% if(page.mathjax){ %>
    <!-- MathJax配置，可通过单美元符号书写行内公式等 -->
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
    "HTML-CSS": {
        preferredFont: "TeX",
        availableFonts: ["STIX","TeX"],
        linebreaks: { automatic:true },
        EqnChunk: (MathJax.Hub.Browser.isMobile ? 10 : 50)
    },
    tex2jax: {
        inlineMath: [ ["$", "$"], ["\\(","\\)"] ],
        processEscapes: true,
        ignoreClass: "tex2jax_ignore|dno",
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    },
    TeX: {
        equationNumbers: { autoNumber: "AMS" },
        noUndefined: { attributes: { mathcolor: "red", mathbackground: "#FFEEEE", mathsize: "90%" } },
        Macros: { href: "{}" }
    },
    messageStyle: "none"
    });
</script>
    <!-- 给MathJax元素添加has-jax class -->
    <script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += 'has-jax';
        }
    });
</script>
    <!-- 通过连接CDN加载MathJax的js代码 -->
    <script type="text/javascript" async
            src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
    </script>
<% } %>
