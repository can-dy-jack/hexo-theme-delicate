<% 
    page.date.locale(config.language);
%>
<div class="page-body page-shadow">
    <section class="page">
        <div class="page-title" <% if(page.font) { %> style="font: <%= page.font %> <% } %>">
            <h1><%- page.title || page.link %></h1>
        </div>
        <div class="blog-post-info">
            <div class="post-author-count">
            <% if(page.author) { %>
                <%= page.author %>  ·
            <% } %>
            <%= __("postInfo.count", wordcount(page.content)) %>,  
            <%= __("postInfo.need", min2read(page.content)) %>
            </div>

            <% if(page.date) { %>
                <div class="post-publish-date">
                    <%= __("postInfo.publish") %>：
                    <%= page.date.format(config.date_format) %>
                    <%= page.date.format(config.time_format) %>
                </div>
            <% } %>
        </div>
        <%- page.content %>

        <% if(page.comments) { %>
            <% if(theme.comments.utteranc.enable) { %>
                <script src="https://utteranc.es/client.js"
                    repo="<%= theme.comments.utteranc.repo %>"
                    issue-term="<%= page.title %>"
                    theme="<%= theme.comments.utteranc.theme %>"
                    crossorigin="anonymous"
                    async>
                </script>
            <% } %>
            <% if(theme.comments.changyan.enable) { %>
                <div id="SOHUCS" sid="<%= hash(page.title) %>" class="clear-markdwon-a"></div>
                <script charset="utf-8" type="text/javascript" src="https://cy-cdn.kuaizhan.com/upload/changyan.js" ></script>
                <script type="text/javascript">
                    window.changyan.api.config({
                        appid: '<%= theme.comments.changyan.appid %>',
                        conf: '<%= theme.comments.changyan.conf %>'
                    });
                </script>
            <% } %>
            <% if(theme.comments.valine.enable) { %>
            <div id="vcomments" class="clear-markdwon-a"></div>
            <script src='//unpkg.com/valine/dist/Valine.min.js'></script>
            <script>
                new Valine({
                    el: "#vcomments",
                    app_id: "<%= theme.comments.valine.app_id %>",
                    app_key: "<%= theme.comments.valine.app_key %>",
                    avatar: "<%= theme.comments.valine.avatar %>",
                    placeholder: "<%= theme.comments.valine.placeholderr %>",
                    visitor: "<%= theme.comments.valine.visitor %>", // 阅读量统计
                });
            </script>
            <% } %>
            <% if(theme.comments.disqus.enable) { %>
                <div id="disqus_thread" class="clear-markdwon-a"></div>
                <script>
                    var disqus_config = function () {
                        this.page.url = document.URL;
                        this.page.identifier = document.title;
                    };
                    (function() { 
                        var d = document, s = d.createElement('script');
                        s.src = '<%= theme.comments.disqus.mainJs %>';
                        s.setAttribute('data-timestamp', +new Date());
                        (d.head || d.body).appendChild(s);
                    })();
                </script>
                <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

                <a class="disqus-comment-count"></a>
                <script id="dsq-count-scr" src="<%= theme.comments.disqus.countJs %>" async></script>
            <% } %>
            <% if(theme.comments.gitalk.enable) { %>
                <script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
                <div id="gitalk-container" class="clear-markdwon-a"></div>
                <script>
                    var gitalk = new Gitalk({
                        clientID: '<%= theme.comments.gitalk.clientID %>',
                        clientSecret: '<%= theme.comments.gitalk.clientID %>',
                        repo: '<%= theme.comments.gitalk.repo %>',
                        owner: '<%= theme.comments.gitalk.owner %>',
                        admin: ['<%= theme.comments.gitalk.owner %>'],
                        id: location.pathname,
                        distractionFreeMode: false,
                        labels: ['Gitalk'],
                        language: "<%= theme.comments.gitalk.language %>"
                    })
                    gitalk.render('gitalk-container')
                </script>
            <% } %>
            <% if(theme.comments.gitment.enable) { %>
                <div id="gitment-container" class="clear-markdwon-a"></div>
                <script src="https://imsun.github.io/gitment/dist/gitment.browser.js"></script>
                <script>
                    var gitment = new Gitment({
                        id: location.pathname,
                        owner: '<%= theme.comments.gitalk.owner %>',
                        repo: '<%= theme.comments.gitalk.repo %>',
                        oauth: {
                            client_id: '<%= theme.comments.gitalk.clientID %>',
                            client_secret: '<%= theme.comments.gitalk.clientID %>',
                        },
                    })
                    gitment.render('gitment-container')
                </script>
            <% } %>
            <% if(theme.comments.vssue.enable) { %>
                <div id="vssue"></div>
                <script src="https://cdn.jsdelivr.net/npm/vue@2.6.10/dist/vue.min.js"></script>
                <script src="https://unpkg.com/vssue@1.4.8/dist/vssue.<%= theme.comments.vssue.platform %>.min.js"></script>
                <script>
                new Vue({
                    el: '#vssue',
                    data: {
                    title: location.pathname,
                    options: {
                        clientId: '<%= theme.comments.gitalk.clientID %>',
                        clientSecret: '<%= theme.comments.gitalk.clientID %>',
                        repo: '<%= theme.comments.gitalk.repo %>',
                        owner: '<%= theme.comments.gitalk.owner %>',
                    },
                    },
                    template: `<vssue :title="title" :options="options"></vssue>`,
                })
                </script>
            <% } %>
            <% if(theme.comments.livere.enable) { %>
                <div id="lv-container" data-id="city" data-uid="<%= theme.comments.livere.dataUid %>">
                    <script type="text/javascript">
                        (function(d, s) {
                            var j, e = d.getElementsByTagName(s)[0];
                            if (typeof LivereTower === 'function') { return; }
                            j = d.createElement(s);
                            j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
                            j.async = true;
                            e.parentNode.insertBefore(j, e);
                        })(document, 'script');
                    </script>
                <noscript>为正常使用来必力评论功能请激活JavaScript</noscript>
                </div>
            <% } %>
            <% if(theme.comments.giscus.enable) { %>
            <script src="https://giscus.app/client.js"
                    data-repo="<%= theme.comments.giscus.repo %>"
                    data-repo-id="<%= theme.comments.giscus.repoId %>"
                    data-category="<%= theme.comments.giscus.category %>"
                    data-category-id="<%= theme.comments.giscus.categoryId %>"
                    data-mapping="<%= theme.comments.giscus.mapping %>"
                    data-strict="0"
                    data-reactions-enabled="1"
                    data-emit-metadata="0"
                    data-input-position="<%= theme.comments.giscus.inputPosition %>"
                    data-theme="<%= theme.comments.giscus.theme %>"
                    data-lang="<%= theme.comments.giscus.lang %>"
                    crossorigin="anonymous"
                    async>
            </script>
            <% } %>
        <% } %>

    </section>
</div>
